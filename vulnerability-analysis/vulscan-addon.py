#!/usr/bin/env python
#####################################
# Installation module for Vulscan
#####################################

# AUTHOR OF MODULE NAME
AUTHOR="SCIP AG"

# DESCRIPTION OF THE MODULE
DESCRIPTION="This module will install/update Vulscan (Nmap NSE Script)."

# INSTALL TYPE GIT, SVN, FILE DOWNLOAD
# OPTIONS = GIT, SVN, FILE
INSTALL_TYPE="GIT"

# LOCATION OF THE FILE OR GIT/SVN REPOSITORY
REPOSITORY_LOCATION="https://github.com/scipag/vulscan.git"

# WHERE DO YOU WANT TO INSTALL IT
INSTALL_LOCATION="vulscan"

# DEPENDS FOR DEBIAN INSTALLS
DEBIAN="git,curl,nmap"

# DEPENDS FOR FEDORA INSTALLS
FEDORA="git,curl,nmap"

# DEPENDS FOR ARCHLINUX INSTALLS
ARCHLINUX="git,curl,nmap"

# THIS WILL STILL RUN AFTER COMMANDS EVEN IF ITS ALREADY INSTALLED. USEFUL FOR FILE UPDATES AND WHEN NOT USING GIT OR OTHER APPLICATIONS THAT NEEDS AFTER COMMANDS EACH TIME
BYPASS_UPDATE="NO"

# COMMANDS TO RUN AFTER
AFTER_COMMANDS="mkdir -p /usr/share/nmap/scripts/vulscan/,updatedb,timeout 300 curl --progress -k -L -f "http://www.computec.ch/projekte/vulscan/download/cve.csv" > /usr/share/nmap/scripts/vulscan/cve.csv,timeout 300 curl --progress -k -L -f "http://www.computec.ch/projekte/vulscan/download/exploitdb.csv" > /usr/share/nmap/scripts/vulscan/exploitdb.csv,timeout 300 curl --progress -k -L -f "http://www.computec.ch/projekte/vulscan/download/openvas.csv" > /usr/share/nmap/scripts/vulscan/openvas.csv,timeout 300 curl --progress -k -L -f "http://www.computec.ch/projekte/vulscan/download/osvdb.csv" > /usr/share/nmap/scripts/vulscan/osvdb.csv,timeout 300 curl --progress -k -L -f "http://www.computec.ch/projekte/vulscan/download/scipvuldb.csv" > /usr/share/nmap/scripts/vulscan/scipvuldb.csv,timeout 300 curl --progress -k -L -f "http://www.computec.ch/projekte/vulscan/download/securityfocus.csv" > /usr/share/nmap/scripts/vulscan/securityfocus.csv,timeout 300 curl --progress -k -L -f "http://www.computec.ch/projekte/vulscan/download/securitytracker.csv" > /usr/share/nmap/scripts/vulscan/securitytracker.csv,timeout 300 curl --progress -k -L -f "http://www.computec.ch/projekte/vulscan/download/xforce.csv" > /usr/share/nmap/scripts/vulscan/xforce.csv,cp -r {INSTALL_LOCATION}/* /usr/share/nmap/scripts/vulscan/"

# THIS WILL CREATE AN AUTOMATIC LAUNCHER FOR THE TOOL
LAUNCHER="vulscan"

# PREREQ INSTALL MODULES NEEDED FOR THIS TOOL TO WORK PROPERLY
TOOL_DEPEND=""
